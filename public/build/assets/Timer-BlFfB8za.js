import{H as B,c as s,b as t,t as u,u as v,L as x,a as D,w as G,o as n,a2 as U,j as f,i as L,s as d,z as I,a3 as N,a1 as F}from"./app-j5Ti9vKF.js";import{c as C}from"./confetti.module-oQXWb4Lk.js";import{_ as K}from"./_plugin-vue_export-helper-DlAUqK2U.js";const E={class:"h-24 md:h-28 flex items-center justify-center px-4 w-full max-w-2xl text-center mb-4"},R={key:1,class:"text-lg md:text-xl font-bold text-gray-400"},z={class:"relative w-64 h-64 md:w-80 md:h-80 flex items-center justify-center mb-10"},H={class:"w-full h-full -rotate-90 drop-shadow-xl"},$=["stroke","stroke-dashoffset"],P={class:"absolute flex flex-col items-center"},V={class:"text-7xl md:text-8xl font-black text-gray-700 tabular-nums tracking-tighter"},O={class:"w-full max-w-md px-4 relative z-20"},W={key:0,class:"w-full h-48 bg-gray-100 rounded-3xl flex flex-col items-center justify-center border-4 border-dashed border-gray-300 hover:bg-gray-50 transition-colors"},q=["src"],J={class:"space-y-3"},Q=["disabled"],X={key:0,class:"animate-spin"},Y={key:2,class:"text-center text-gray-400 font-bold mt-6 animate-pulse"},Z={class:"fixed bottom-0 left-0 p-4 opacity-10 pointer-events-none text-9xl -rotate-12"},ee={class:"fixed top-0 right-0 p-4 opacity-10 pointer-events-none text-9xl rotate-12"},te={__name:"Timer",props:{student:Object,type:String},setup(i){const g=i,o={brushing:{title:"ðŸ¦· SIKAT GIGI CERIA",duration:120,steps:[{time:0,text:"Siapkan sikat & pasta gigi sebesar biji jagung ðŸŒ½"},{time:10,text:"Sikat gigi depan bagian luar (Naik-Turun) â†•ï¸"},{time:30,text:"Sikat gigi belakang bagian luar (Memutar) ðŸ”„"},{time:50,text:"Sikat permukaan kunyah gigi (Maju-Mundur) â†”ï¸"},{time:70,text:"Sikat gigi bagian dalam (Cungkil keluar) â†—ï¸"},{time:90,text:"Sikat lidahmu pelan-pelan ðŸ‘…"},{time:110,text:"Kumur-kumur dengan air bersih ðŸ’§"}],color:"text-blue-600",bg:"bg-blue-50"},handwashing:{title:"ðŸ§¼ CUCI TANGAN SEHAT",duration:60,steps:[{time:0,text:"Basahi tangan & tuang sabun secukupnya ðŸ§´"},{time:10,text:"Gosok telapak tangan dengan memutar ðŸ‘"},{time:20,text:"Gosok punggung tangan kanan & kiri ðŸ¤š"},{time:30,text:"Gosok sela-sela jari tangan ðŸ¤ž"},{time:40,text:"Kunci jari-jari (Gerakan mengunci) âœŠ"},{time:50,text:"Putar ibu jari & ujung kuku di telapak tangan ðŸ‘Œ"},{time:58,text:"Bilas air mengalir & keringkan! ðŸŒ¬ï¸"}],color:"text-green-600",bg:"bg-green-50"}}[g.type],k=o.duration,c=d(k),l=d(!1),m=d(!1),y=d(null),b=d(null),p=d(!1);let h=null;const w=I(()=>{const a=k-c.value,e=o.steps.slice().reverse().find(r=>a>=r.time);return e?e.text:"Siap-siap..."}),_=2*Math.PI*120,j=I(()=>_*(1-c.value/k)),T=()=>{l.value||(l.value=!0,h=setInterval(()=>{c.value>0?c.value--:S()},1e3))},S=()=>{clearInterval(h),l.value=!1,m.value=!0,C({particleCount:100,spread:70,origin:{y:.6}})},M=a=>{const e=a.target.files[0];if(e){if(e.size>5*1024*1024){alert("Waduh! Foto terlalu besar (Max 5MB). Coba turunkan resolusi kamera atau pilih foto lain ya! ðŸ“¸");return}y.value=e,b.value=URL.createObjectURL(e)}},A=async()=>{if(!y.value){alert("Eits, foto dulu buktinya ya biar dapat bintang! ðŸ“¸");return}p.value=!0;const a=new FormData;a.append("student_id",parseInt(g.student.id)),a.append("type",g.type),a.append("proof",y.value),a.append("duration",o.duration),a.append("is_quiz",0);try{const e=await N.post("/activity/store",a,{headers:{"Content-Type":"multipart/form-data"}});C({particleCount:200,spread:100,origin:{y:.6}}),setTimeout(()=>{alert("Hore! Laporanmu diterima Pak Dokter! ðŸŒŸ"),F.visit(`/dashboard/${g.student.id}`)},1500)}catch(e){console.error("Gagal Upload:",e.response?.data||e);let r="Gagal mengirim laporan.";e.response?.status===422?(r="Data tidak lengkap (Cek Tipe/Foto).",console.log("Detail Error:",e.response.data.errors)):e.response?.status===413&&(r="Ukuran foto terlalu besar! Maksimal 5MB."),alert(r),p.value=!1}};return B(()=>clearInterval(h)),(a,e)=>(n(),s("div",{class:x(["min-h-screen flex flex-col items-center justify-center p-4 font-['Comic_Sans_MS',_sans-serif] relative overflow-hidden transition-colors duration-500",v(o).bg])},[t("h1",{class:x(["text-3xl md:text-5xl font-black mb-6 text-center drop-shadow-sm uppercase tracking-wide",v(o).color])},u(v(o).title),3),t("div",E,[D(U,{name:"fade",mode:"out-in"},{default:G(()=>[l.value||m.value?(n(),s("p",{key:w.value,class:"text-xl md:text-3xl font-bold text-gray-700 bg-white/80 px-6 py-4 rounded-3xl shadow-lg border-2 border-white backdrop-blur-sm animate-pulse-slow"},u(w.value),1)):(n(),s("p",R," Tekan tombol MULAI di bawah ya! ðŸ‘‡ "))]),_:1})]),t("div",z,[(n(),s("svg",H,[e[2]||(e[2]=t("circle",{cx:"50%",cy:"50%",r:"45%",stroke:"white","stroke-width":"20",fill:"white",class:"opacity-50"},null,-1)),t("circle",{cx:"50%",cy:"50%",r:"45%",stroke:i.type==="brushing"?"#3b82f6":"#22c55e","stroke-width":"20",fill:"transparent","stroke-linecap":"round",class:"transition-all duration-1000 ease-linear","stroke-dasharray":_,"stroke-dashoffset":j.value},null,8,$)])),t("div",P,[t("span",V,u(c.value),1),e[3]||(e[3]=t("span",{class:"text-lg md:text-xl font-bold text-gray-400 uppercase tracking-widest"},"Detik",-1))])]),t("div",O,[!l.value&&!m.value?(n(),s("button",{key:0,onClick:T,class:x(["w-full text-white text-2xl md:text-3xl font-black py-5 md:py-6 rounded-[2.5rem] shadow-[0_8px_0_0_rgba(0,0,0,0.2)] active:shadow-none active:translate-y-2 transition-all hover:scale-105",i.type==="brushing"?"bg-blue-500 hover:bg-blue-600 shadow-blue-700":"bg-green-500 hover:bg-green-600 shadow-green-700"])}," MULAI SEKARANG! ðŸš€ ",2)):f("",!0),m.value?(n(),s("div",{key:1,class:x(["bg-white p-6 md:p-8 rounded-[2.5rem] shadow-2xl border-4 animate-in fade-in slide-in-from-bottom-10 duration-500",i.type==="brushing"?"border-blue-100":"border-green-100"])},[e[5]||(e[5]=t("h2",{class:"text-2xl font-black text-gray-700 text-center mb-2"},"ðŸ“¸ Wajib Foto Bukti!",-1)),e[6]||(e[6]=t("p",{class:"text-gray-400 text-center text-xs font-bold mb-6"},"Tanpa foto, bintang tidak bisa diambil :(",-1)),t("div",{class:"mb-4 relative group cursor-pointer",onClick:e[0]||(e[0]=r=>a.$refs.fileInput.click())},[b.value?(n(),s("img",{key:1,src:b.value,class:"w-full h-64 object-cover rounded-3xl border-4 border-yellow-400 shadow-md"},null,8,q)):(n(),s("div",W,[...e[4]||(e[4]=[t("span",{class:"text-4xl mb-2"},"ðŸ“·",-1),t("span",{class:"text-gray-400 font-bold text-sm"},"Ketuk untuk buka kamera",-1)])])),t("input",{ref:"fileInput",type:"file",accept:"image/*",capture:"environment",onChange:M,class:"hidden"},null,544)]),t("div",J,[b.value?(n(),s("button",{key:0,onClick:A,disabled:p.value,class:"w-full bg-yellow-400 hover:bg-yellow-500 text-yellow-900 text-xl font-black py-4 rounded-2xl shadow-[0_6px_0_0_#ca8a04] active:shadow-none active:translate-y-1 transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2"},[p.value?(n(),s("span",X,"â³")):f("",!0),L(" "+u(p.value?"Mengirim...":"KIRIM & AMBIL HADIAH ðŸŽ"),1)],8,Q)):(n(),s("button",{key:1,onClick:e[1]||(e[1]=r=>a.$refs.fileInput.click()),class:"w-full bg-gray-100 hover:bg-gray-200 text-gray-600 text-lg font-bold py-4 rounded-2xl border-2 border-gray-200"}," Buka Kamera "))])],2)):f("",!0),l.value?(n(),s("p",Y," Ikuti langkah di atas ya! Semangat! ðŸ’ª ")):f("",!0)]),t("div",Z,u(i.type==="brushing"?"ðŸ¦·":"ðŸ§¼"),1),t("div",ee,u(i.type==="brushing"?"ðŸª¥":"ðŸ¦ "),1)],2))}},ie=K(te,[["__scopeId","data-v-300e0ec9"]]);export{ie as default};
