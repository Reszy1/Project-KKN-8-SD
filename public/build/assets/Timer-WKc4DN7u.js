import{H as B,c as s,b as e,t as l,j as p,u as y,a1 as v,s as i,z as S,a3 as m,o as n}from"./app-B4frZ8W6.js";import{c as C}from"./confetti.module-oQXWb4Lk.js";const U={class:"min-h-screen bg-sky-50 flex flex-col items-center justify-center p-6 font-['Comic_Sans_MS']"},j={class:"text-4xl font-black text-sky-600 mb-4 text-center"},G={class:"h-16 flex items-center"},H={key:0,class:"text-2xl font-bold text-orange-500 animate-pulse text-center"},L={class:"relative w-72 h-72 flex items-center justify-center mb-10"},D={class:"w-full h-full -rotate-90"},F=["stroke-dasharray","stroke-dashoffset"],P={class:"absolute flex flex-col items-center"},R={class:"text-7xl font-black text-sky-700"},T={class:"flex flex-col items-center gap-4"},K={key:1,class:"bg-white p-6 rounded-[2rem] shadow-xl w-full text-center border-4 border-sky-200 animate-fade-in-up"},N={class:"mb-4 relative group"},E={key:0,class:"w-full h-48 bg-gray-100 rounded-2xl flex items-center justify-center border-2 border-dashed border-gray-300"},$=["src"],J={for:"cameraInput",class:"block w-full bg-blue-500 hover:bg-blue-600 text-white text-xl font-bold py-4 rounded-xl cursor-pointer shadow-lg mb-3 transition-transform active:scale-95"},O=["disabled"],V={key:2,class:"text-center"},Y={class:"fixed bottom-0 left-0 w-full p-4 flex justify-between opacity-30 pointer-events-none"},z={class:"text-9xl"},q={class:"text-9xl"},Z={__name:"Timer",props:{student:Object,type:String},setup(c){const o=c,r=o.type==="brushing"?120:20,u=i(r),f=i(!1),b=i(!1),h=i(null),d=i(null),x=i(!1);let g=null;const k={brushing:["Mulai sikat!","Sikat bagian depan...","Sikat bagian kiri...","Sikat bagian kanan...","Jangan lupa lidahnya!","Hampir berkilau!"],handwashing:["Basahi tangan...","Pakai sabun...","Gosok sela jari...","Punggung tangan...","Bilas bersih!"]},_=a=>{const t=a.target.files[0];t&&(h.value=t,d.value=URL.createObjectURL(t))},w=async()=>{if(!h.value){alert("Jangan lupa foto dulu ya sebagai bukti!");return}x.value=!0;const a=new FormData;a.append("student_id",o.student.id),a.append("type",o.type),a.append("duration",r),a.append("proof",h.value);try{await m.post("/activity/store",a,{headers:{"Content-Type":"multipart/form-data"}}),alert("Hore! Bukti berhasil dikirim ke Ibu Guru! ğŸ“¸"),v.get(`/dashboard/${o.student.id}`)}catch(t){console.error("Gagal upload",t),alert("Yah, gagal kirim. Coba lagi ya!"),x.value=!1}},I=S(()=>{const a=k[o.type],t=Math.floor((r-u.value)/r*a.length);return a[Math.min(t,a.length-1)]}),A=()=>{f.value=!0,g=setInterval(()=>{u.value>0?u.value--:M()},1e3)},M=async()=>{clearInterval(g),f.value=!1,b.value=!0,C({particleCount:150,spread:70,origin:{y:.6}});try{await m.post("/activity/store",{student_id:o.student.id,type:o.type,duration:r})}catch(a){console.error("Gagal menyimpan data",a)}};return B(()=>clearInterval(g)),(a,t)=>(n(),s("div",U,[e("h1",j,l(c.type==="brushing"?"ğŸ¦· ISTANA GIGI":"ğŸ§¼ MARKAS SABUN"),1),e("div",G,[f.value?(n(),s("p",H,' "'+l(I.value)+'" ',1)):p("",!0)]),e("div",L,[(n(),s("svg",D,[t[1]||(t[1]=e("circle",{cx:"144",cy:"144",r:"120",stroke:"currentColor","stroke-width":"15",fill:"transparent",class:"text-gray-200"},null,-1)),e("circle",{cx:"144",cy:"144",r:"120",stroke:"currentColor","stroke-width":"15",fill:"transparent",class:"text-sky-500 transition-all duration-1000","stroke-dasharray":2*Math.PI*120,"stroke-dashoffset":2*Math.PI*120*(1-u.value/y(r))},null,8,F)])),e("div",P,[e("span",R,l(u.value),1),t[2]||(t[2]=e("span",{class:"text-xl font-bold text-sky-500"},"Detik Lagi",-1))])]),e("div",T,[!f.value&&!b.value?(n(),s("button",{key:0,onClick:A,class:"bg-orange-500 hover:bg-orange-600 text-white text-3xl font-black px-12 py-6 rounded-[40px] shadow-[0_10px_0_0_#c2410c] active:shadow-none active:translate-y-2 transition-all"}," MULAI SEKARANG! ğŸš€ ")):p("",!0),b.value?(n(),s("div",K,[t[4]||(t[4]=e("h2",{class:"text-2xl font-black text-sky-600 mb-4"},"ğŸ“¸ Foto Bukti Dulu Yuk!",-1)),e("div",N,[d.value?(n(),s("img",{key:1,src:d.value,class:"w-full h-64 object-cover rounded-2xl border-4 border-yellow-400 shadow-md"},null,8,$)):(n(),s("div",E,[...t[3]||(t[3]=[e("span",{class:"text-gray-400 text-sm"},"Hasil foto akan muncul di sini",-1)])])),e("input",{type:"file",id:"cameraInput",accept:"image/*",capture:"user",onChange:_,class:"hidden"},null,32)]),e("label",J,l(d.value?"ğŸ”„ Foto Ulang":"ğŸ“· Buka Kamera"),1),d.value?(n(),s("button",{key:0,onClick:w,disabled:x.value,class:"w-full bg-green-500 hover:bg-green-600 text-white text-xl font-bold py-4 rounded-xl shadow-[0_6px_0_0_#15803d] active:shadow-none active:translate-y-1 transition-all disabled:opacity-50"},l(x.value?"Mengirim...":"Kirim ke Ibu Guru! âœˆï¸"),9,O)):p("",!0)])):p("",!0),b.value?(n(),s("div",V,[t[5]||(t[5]=e("h2",{class:"text-3xl font-black text-green-600 mb-6"},"HEBAT! KAMU BERHASIL! âœ¨",-1)),e("button",{onClick:t[0]||(t[0]=Q=>y(v).get(`/dashboard/${c.student.id}`)),class:"bg-sky-500 hover:bg-sky-600 text-white text-2xl font-black px-10 py-5 rounded-[30px] shadow-[0_8px_0_0_#0369a1]"}," AMBIL HADIAHMU ğŸ ")])):p("",!0)]),e("div",Y,[e("span",z,l(c.type==="brushing"?"ğŸª¥":"ğŸ§¼"),1),e("span",q,l(c.type==="brushing"?"ğŸ¦·":"ğŸ¦ "),1)])]))}};export{Z as default};
